<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Juego de Memoria ‚Äì Versi√≥n Especial</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
    /* FIX iPhone: evitar fondo blanco */
    html, body {
        background-color: #000 !important;
        color-scheme: only dark;
        -webkit-appearance: none;
    }

    :root {
        --bg: #000;
        --card: #0f0f0f;
        --text: #f1f1f1;
        --soft: #bbbbbb;
        --accent: #ffe817;
    }

    * { 
        margin:0; 
        padding:0; 
        box-sizing:border-box; 
        -webkit-transform-style: preserve-3d;
    }

    body {
        background: radial-gradient(circle, #1b1b1b 0%, #000 70%);
        min-height:100vh;
        font-family:"Poppins", sans-serif;
        color:var(--text);
        display:flex;
        flex-direction:column;
        align-items:center;
        padding:2rem 1rem 4rem;
        overflow-x:hidden;
        position:relative;
    }

    /* üåå Fondo de estrellas compatible con iPhone */
    .stars {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        z-index: -1;
        pointer-events: none;
        background:#000 !important;
    }

    .stars::before,
    .stars::after {
        content: "";
        position: absolute;
        width: 200%;
        height: 200%;
        top: -50%;
        left: -50%;
        opacity: 0.12 !important; /* FIX iPhone que lo ve√≠a blanco */
    }

    .stars::before {
        background: radial-gradient(white 1px, transparent 1px);
        background-size: 3px 3px;
        animation: drift 60s linear infinite, twinkle 3s ease-in-out infinite;
        filter: blur(0.8px);
    }

    .stars::after {
        background: radial-gradient(#ffe817 1px, transparent 1px);
        background-size: 4px 4px;
        animation: drift 120s linear infinite, twinkle 5s ease-in-out infinite;
        filter: blur(1.2px);
    }

    @keyframes drift {
        from { transform: translate(0,0); }
        to   { transform: translate(-600px, -600px); }
    }

    @keyframes twinkle {
        0%   { opacity: 0.1; }
        50%  { opacity: 0.35; }
        100% { opacity: 0.1; }
    }

    /* üå† Estrella fugaz */
    .shooting-star {
        position: fixed;
        top: -10px;
        left: -10px;
        width: 3px;
        height: 3px;
        background: white;
        box-shadow: 0 0 12px white, 0 0 20px #ffe817;
        border-radius: 50%;
        opacity: 0;
        transform: rotate(45deg);
        animation: shooting 2s ease-in-out forwards;
        z-index: -1;
    }

    @keyframes shooting {
        0% {
            opacity: 1;
            transform: translate(-50px, -50px) rotate(45deg);
        }
        100% {
            opacity: 0;
            transform: translate(120vw, 120vh) rotate(45deg);
        }
    }

    /* M√∫sica */
    audio { display:none; }

    h1 {
        font-size: clamp(1.6rem, 4vw, 2.4rem);
        font-weight: 600;
        letter-spacing: 0.25em;
        text-align:center;
        color:var(--soft);
        margin-bottom:0.7rem;
        text-transform:uppercase;
    }

    .subtitle {
        font-size:0.9rem;
        color:var(--soft);
        margin-bottom:2rem;
        text-align:center;
    }

    .board {
        width:100%;
        max-width:680px;
        display:grid;
        grid-template-columns: repeat(4, 1fr);
        gap:16px;
    }

    .card {
        background: var(--card);
        border-radius:14px;
        height:100px;
        cursor:pointer;
        transition:0.3s;
        position:relative;
        transform-style:preserve-3d;
        border:1px solid rgba(255,255,255,0.1);
    }

    .card-inner {
        width:100%;
        height:100%;
        position:relative;
        transform-style:preserve-3d;
        transition: transform .6s;
    }

    .card.flip .card-inner {
        transform: rotateY(180deg);
    }

    .front, .back {
        position:absolute;
        width:100%;
        height:100%;
        backface-visibility:hidden;
        border-radius:14px;
        display:flex;
        justify-content:center;
        align-items:center;
    }

    .back {
        background:var(--accent);
        color:#000;
        font-weight:600;
        font-size:1.6rem;
    }

    .front {
        transform: rotateY(180deg);
        background:var(--card);
        border:1px solid rgba(255,255,255,0.1);
        font-size:2rem;
        color: var(--accent);
    }

    .message {
    position: fixed;
    bottom: -250px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255,255,255,0.07);
    border: 1px solid rgba(255,255,255,0.1);
    padding: 1.4rem 1.7rem;
    width: 92%;
    max-width: 520px;
    border-radius: 16px;
    text-align: center;
    font-size: 1rem;
    color: var(--soft);
    backdrop-filter: blur(12px);
    transition: all .55s ease;
    line-height: 1.6;
    z-index: 2000; /* ‚≠ê SIEMPRE arriba de todo */
}

/* Cuando aparece */
.message.show {
    bottom: 90px;  /* ‚≠ê Sube m√°s el mensaje */
}

/* Ajuste especial para pantallas muy peque√±as */
@media (max-height: 750px) {
    .message.show {
        bottom: 110px; /* lo sube m√°s para iPhones peque√±os */
    }
}

    .buttons {
        margin-top:2.3rem;
        display:flex;
        gap:1rem;
        justify-content:center;
        flex-wrap:wrap;
    }

    .btn {
        padding:0.7rem 1.9rem;
        border-radius:999px;
        font-weight:600;
        text-transform:uppercase;
        letter-spacing:0.05em;
        font-size:0.85rem;
        cursor:pointer;
        transition:.2s;
        text-decoration:none;
    }

    .btn-primary { background:var(--accent); color:#000; }
    .btn-primary:hover { transform:translateY(-2px); }
</style>
</head>

<body>

<div class="stars"></div>

<h1>Juego de Memoria</h1>
<div class="subtitle">Encuentra los pares ‚ú®</div>

<!-- üéµ M√öSICA -->
<audio id="bgMusic" loop>
    <source src="img/suave.mp3" type="audio/mpeg">
</audio>

<div class="board" id="board"></div>

<div class="message" id="messageBox"></div>

<div class="buttons">
    <a href="index.html" class="btn btn-primary">Volver al inicio</a>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
/* ----------------------------------------------------------
   FIX PARA iPHONE: activar m√∫sica solo si el usuario toca
---------------------------------------------------------- */
const audio = document.getElementById("bgMusic");

function enableAudio() {
    audio.volume = 0.5;
    audio.play().catch(()=>{});
    document.removeEventListener("touchstart", enableAudio);
    document.removeEventListener("click", enableAudio);
}

document.addEventListener("touchstart", enableAudio, { once: true });
document.addEventListener("click", enableAudio, { once: true });

/* ----------------------------------------------------------
   Vibraci√≥n compatible con iPhone
---------------------------------------------------------- */
function vibrate() {
    try {
        window.navigator.vibrate = window.navigator.vibrate || window.navigator.webkitVibrate;
        if (navigator.vibrate) navigator.vibrate([50]);
    } catch(e){}
}

/* ----------------------------------------------------------
   √çconos del juego
---------------------------------------------------------- */
const icons = ["‚≠ê","üåô","üåº","üéß","üìò","üíõ"];
let cards = [...icons, ...icons];

for (let i = cards.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [cards[i], cards[j]] = [cards[j], cards[i]];
}

const board = document.getElementById("board");
let first = null;
let lock = false;
let matches = 0;

/* ----------------------------------------------------------
   Frases especiales (sin cambios)
---------------------------------------------------------- */
const phrases = [
    "T√∫ eres una persona muy dedicada; entre trabajo, estudios y pendientes siempre encontraste la manera de seguir avanzando.",
    "Admiro la forma en que te esfuerzas por cumplir tus metas y no te conformas con lo f√°cil.",
    "Espero y sigas sacando 10 en los parciales.",
    "Espero un d√≠a escuchar que la administradora Kenely ya est√° graduada.",
    "Espero que sigas disfrutando los d√≠as con clima raro como te gustan.",

    "Sabes que siempre estar√© para t√≠, por si alg√∫n d√≠a necesitas algo.",
    "Espero alg√∫n d√≠a ver la empresa KL sea una realidad.",
    "Tu capacidad para adaptarte al trabajo es algo que pocas personas tienen, sigue siendo una persona resiliente.",
    "Espero y no empieces tarde a cumplir tus sue√±os.",

    "Espero y que el destino no te siga impidiendo ir al gym.",
    "Cu√≠date mucho, eres muy importante para m√≠.",

    "Toma mucha agua, duerme temprano (aunque eso ya lo haces) y siempre ten cuidado cuando salgas.",
    "La playlist KL que te hice con la m√∫sica que te gustaba, quiero que sepas que la escucho casi todos los d√≠as.",

    "Se nota que valoras mucho a tu familia y a las personas importantes para ti.",
    "Espero que alg√∫n d√≠a tu sue√±o de trabajar en la capital se te cumpla.",
    "Esperemos que la manifestaci√≥n del aumento alg√∫n d√≠a se cumpla.",

    "Me gustaba cuando contabas tu d√≠a en el trabajo o en la U; hac√≠as todo sonar m√°s ligero.",
    "Tus gustos, tu m√∫sica y tus conversaciones hicieron varios d√≠as m√°s agradables.",
    "Aprecio la confianza con la que me compartiste tus metas y parte de tu vida.",
    "Fue bonito coincidir contigo, aunque solo haya sido por un tramo peque√±o.",
    "Me quedo con lo bueno, porque lo bueno contigo fue genuino.",
    "Recordarte as√≠, enfocada en tus metas y en tu futuro, es algo que siempre voy a valorar.",
    "Eres m√°s capaz de lo que te imaginas.",
    "Gracias por confiar y compartir partes de tu vida conmigo.",
  "Tus mensajes hicieron m√°s ligeros muchos d√≠as.",
  "Te mereces personas que te cuiden como t√∫ cuidas a los dem√°s.",
  "Ojal√° nunca dudes del futuro tan bonito que puedes construir.",
  "Tienes una mezcla rara y bonita de fuerza y ternura.",
  "De verdad deseo que encuentres gente que valore todo lo que eres.",
  "Ojal√° nunca olvides lo mucho que vales, aun en tus d√≠as cansados."
];

const msg = document.getElementById("messageBox");

/* ----------------------------------------------------------
   Sistema de frases aleatorias SIN REPETIR
---------------------------------------------------------- */

function shuffle(array) {
    let current = array.length, random;
    while (current !== 0) {
        random = Math.floor(Math.random() * current);
        current--;
        [array[current], array[random]] = [array[random], array[current]];
    }
    return array;
}

// Mezclamos las frases solo una vez
let phraseQueue = shuffle([...phrases]);
let phraseIndex = 0;

function showPhrase() {
    // Si ya mostramos todas, volvemos a mezclar
    if (phraseIndex >= phraseQueue.length) {
        phraseQueue = shuffle([...phrases]);
        phraseIndex = 0;
    }

    const text = phraseQueue[phraseIndex];
    phraseIndex++;

    msg.innerHTML = text;
    msg.classList.add("show");

    setTimeout(() => msg.classList.remove("show"), 4500);
}


/* ----------------------------------------------------------
   Crear las cartas
---------------------------------------------------------- */
cards.forEach(icon => {
    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
        <div class="card-inner">
            <div class="back">?</div>
            <div class="front">${icon}</div>
        </div>
    `;

    card.addEventListener("click", () => {
        vibrate(); // FIX iPhone: vibraci√≥n debe venir del toque

        if (lock || card.classList.contains("flip")) return;

        card.classList.add("flip");

        if (!first) {
            first = card;
        } else {
            lock = true;

            const match =
                first.querySelector(".front").innerHTML ===
                card.querySelector(".front").innerHTML;

            if (match) {
                showPhrase();
                matches++;

                setTimeout(() => {
                    first.style.opacity = "0.35";
                    card.style.opacity = "0.35";
                    first = null;
                    lock = false;
                }, 600);

                if (matches === icons.length) {
                    setTimeout(() => {
                        confetti({
                            particleCount: 200,
                            spread: 90,
                            origin: { y: 0.6 },
                            colors: ["#ffe817", "#ffffff"]
                        });
                    }, 900);
                }

            } else {
                setTimeout(() => {
                    first.classList.remove("flip");
                    card.classList.remove("flip");
                    first = null;
                    lock = false;
                }, 900);
            }
        }
    });

    board.appendChild(card);
});

/* ----------------------------------------------------------
   Estrella fugaz
---------------------------------------------------------- */
function createShootingStar() {
    const star = document.createElement("div");
    star.className = "shooting-star";
    document.body.appendChild(star);
    setTimeout(() => star.remove(), 2000);
}

setInterval(() => {
    createShootingStar();
}, Math.random() * 4000 + 8000);

</script>

</body>
</html>
